<div class="success-notification" id="successNotification">
  <i class="fas fa-check-circle success-icon"></i>
  <h2 class="success-message">¡Registro exitoso!</h2>
  <p class="success-submessage">Redirigiendo a tu cuenta...</p>
</div>

<main class="login-main" [style.background-image]="'url(assets/img/entrar.jpg)'">
  <div class="login-container register">
    <div class="login-header">
      <h1>Regístrate</h1>
      <p>Completa tus datos para crear una cuenta</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

      <!-- Nombre / Apellido -->
      <div class="row-inputs">
        <div class="input-group-wrapper">
          <div class="input-group" [ngClass]="{'valid': nombre?.valid, 'invalid': nombre?.invalid && nombre?.touched}">
            <i class="fas fa-user"></i>
            <input type="text" formControlName="nombre" placeholder="Nombre" (input)="updateFieldCriteria('nombre')">
          </div>
          <ul class="validation-checklist">
            <li [class.valid]="nombreCriteria.letters">✅ Solo letras</li>
            <li [class.valid]="nombreCriteria.minLength">✅ Mínimo 3 letras</li>
          </ul>
        </div>

        <div class="input-group-wrapper">
          <div class="input-group" [ngClass]="{'valid': apellido?.valid, 'invalid': apellido?.invalid && apellido?.touched}">
            <i class="fas fa-user"></i>
            <input type="text" formControlName="apellido" placeholder="Apellido" (input)="updateFieldCriteria('apellido')">
          </div>
          <ul class="validation-checklist">
            <li [class.valid]="apellidoCriteria.letters">✅ Solo letras</li>
            <li [class.valid]="apellidoCriteria.minLength">✅ Mínimo 3 letras</li>
          </ul>
        </div>
      </div>

      <!-- Email -->
      <div class="input-group-wrapper">
        <div class="input-group" [ngClass]="{'valid': email?.valid, 'invalid': email?.invalid && email?.touched}">
          <i class="fas fa-envelope"></i>
          <input type="email" formControlName="email" placeholder="Correo electrónico" (input)="updateFieldCriteria('email')">
        </div>
        <ul class="validation-checklist">
          <li [class.valid]="fieldCriteria.email.required">✅ Email requerido</li>
          <li [class.valid]="fieldCriteria.email.valid">✅ Formato válido: usuario&#64;dominio</li>
        </ul>
      </div>

      <!-- Contraseña / Repetir Contraseña -->
      <div class="row-inputs">
        <!-- Contraseña -->
        <div class="input-group-wrapper">
          <div class="input-group" [ngClass]="{'valid': password?.valid, 'invalid': password?.invalid && password?.touched}">
            <i class="fas fa-lock"></i>
            <input type="password" formControlName="password" placeholder="Contraseña" (input)="updatePasswordCriteria()">



            <i class="fas toggle-eye"
               [ngClass]="{
                  'fa-eye': !passwordVisible,
                  'fa-eye-slash': passwordVisible
                 }"
               (click)="togglePasswordVisibility()">
            </i>

          </div>
          <ul class="validation-checklist">
            <li [class.valid]="passwordCriteria.hasUpper">✅ Al menos una mayúscula</li>
            <li [class.valid]="passwordCriteria.hasLower">✅ Al menos una minúscula</li>
            <li [class.valid]="passwordCriteria.hasNumber">✅ Al menos un número</li>
            <li [class.valid]="passwordCriteria.hasSpecial">✅ Un carácter especial (!&#64;#$%^&*.,)</li>
            <li [class.valid]="passwordCriteria.minLength">✅ Mínimo 8 caracteres</li>
          </ul>
        </div>

        <!-- Repetir Contraseña -->
        <div class="input-group-wrapper">
          <div class="input-group"
               [ngClass]="{'valid': repetirPassword?.valid && passwordsMatch,
                     'invalid': repetirPassword?.touched && (!repetirPassword?.valid || !passwordsMatch)}">
            <i class="fas fa-lock"></i>
            <input type="password" formControlName="repetirPassword" placeholder="Repetir contraseña" (input)="checkPasswords()">

            <i class="fas toggle-eye"
               [ngClass]="{
                'fa-eye': !repetirPasswordVisible,
                'fa-eye-slash': repetirPasswordVisible
             }"
               (click)="toggleRepetirPasswordVisibility()">
            </i>

          </div>
          <ul class="validation-checklist">
            <li [class.valid]="passwordsMatch">✅ Las contraseñas coinciden</li>
          </ul>
        </div>
      </div>

      <div class="options">
        <div class="remember-me">
          <a routerLink="/home" class="volver-inicio">-> Volver al inicio</a>
        </div>
      </div>
      <button type="submit" class="login-btn">Registrarse</button>
      <div id="fullScreenError" class="full-screen-error" [class.show]="showFullScreenError">
        <div class="error-content">
          <span class="close-btn" (click)="closeFullScreenError()">×</span>
          <h2>¡Formulario incompleto!</h2>
          <p>Por favor rellene correctamente todos los datos</p>
          <button type="button" (click)="closeFullScreenError()">Entendido</button>
        </div>
      </div>



      <div class="register-link">
        ¿Ya tienes una cuenta? <a [routerLink]="['/iniciar-sesion']">Inicia sesión aquí</a>
      </div>
    </form>
  </div>
</main>
